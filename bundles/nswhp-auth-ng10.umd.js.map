{"version":3,"file":"nswhp-auth-ng10.umd.js","sources":["../../../projects/nswhpauth/src/lib/nswhpauth-config.ts","../../../projects/nswhpauth/src/lib/nswhpauth.service.ts","../../../projects/nswhpauth/src/lib/authentication-material/nswhpauth-material.module.ts","../../../node_modules/tslib/tslib.es6.js","../../../projects/nswhpauth/src/lib/services/storage.service.ts","../../../projects/nswhpauth/src/lib/services/aad.service.ts","../../../projects/nswhpauth/src/lib/components/azure-login/azure-login.component.ts","../../../projects/nswhpauth/src/lib/components/azure-logout/azure-logout.component.ts","../../../projects/nswhpauth/src/lib/components/contact-admin/contact-admin.component.ts","../../../projects/nswhpauth/src/lib/services/iadfp.service.ts","../../../projects/nswhpauth/src/lib/services/vip.service.ts","../../../projects/nswhpauth/src/lib/components/otp/otp.component.ts","../../../projects/nswhpauth/src/lib/components/push/push.component.ts","../../../projects/nswhpauth/src/lib/components/register/register.component.ts","../../../projects/nswhpauth/src/lib/services/AuthenticationInterceptor.service.ts","../../../projects/nswhpauth/src/lib/components/spinner/spinner.component.ts","../../../projects/nswhpauth/src/lib/components/tick/tick.component.ts","../../../projects/nswhpauth/src/lib/nswhpauth.module.ts","../../../projects/nswhpauth/src/lib/nswhpauth.routing.module.ts","../../../projects/nswhpauth/src/public-api.ts","../../../projects/nswhpauth/src/nswhp-auth-ng10.ts"],"sourcesContent":["import { InjectionToken } from '@angular/core';\r\nexport interface INswhpAuthServiceOptions {\r\n  vip: {\r\n    stepUpPath: string,\r\n    domain: string\r\n  };\r\n  adalConfig: adal.Config[];\r\n  adal: {\r\n    pushUrl: string,\r\n    otpUrl: string,\r\n    sendOtpUrl: string,\r\n    registerUrl: string,\r\n  };\r\n}\r\nexport const NSWHP_AUTH_CONFIG = new InjectionToken<INswhpAuthServiceOptions>('NSWHP_AUTH_CONFIG');\r\n","import { Inject, Injectable } from '@angular/core';\nimport { INswhpAuthServiceOptions, NSWHP_AUTH_CONFIG } from './nswhpauth-config';\n\n\n\n@Injectable({\n  providedIn: 'root'\n})\nexport class NswhpAuthService {\n  public nswhpAuthOptions: INswhpAuthServiceOptions;\n  constructor(\n    @Inject(NSWHP_AUTH_CONFIG) options: INswhpAuthServiceOptions,\n  ) {\n    this.nswhpAuthOptions = options;\n  }\n}\n","import { NgModule } from '@angular/core';\r\nimport { MatButtonModule } from '@angular/material/button';\r\nimport { MatCardModule } from '@angular/material/card';\r\nimport { MatChipsModule } from '@angular/material/chips';\r\nimport { MatFormFieldModule } from '@angular/material/form-field';\r\nimport { MatIconModule } from '@angular/material/icon';\r\nimport { MatInputModule } from '@angular/material/input';\r\nimport { MatRadioModule } from '@angular/material/radio';\r\n\r\nconst modules = [\r\n  MatButtonModule,\r\n  MatCardModule,\r\n  MatChipsModule,\r\n  MatFormFieldModule,\r\n  MatIconModule,\r\n  MatInputModule,\r\n  MatRadioModule,\r\n];\r\n\r\n@NgModule({\r\n  imports: [\r\n    modules\r\n  ],\r\n  exports: [\r\n    modules\r\n  ]\r\n})\r\nexport class NswhpAuthMaterialModule { }\r\n","/*! *****************************************************************************\r\nCopyright (c) Microsoft Corporation.\r\n\r\nPermission to use, copy, modify, and/or distribute this software for any\r\npurpose with or without fee is hereby granted.\r\n\r\nTHE SOFTWARE IS PROVIDED \"AS IS\" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH\r\nREGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY\r\nAND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,\r\nINDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM\r\nLOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR\r\nOTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR\r\nPERFORMANCE OF THIS SOFTWARE.\r\n***************************************************************************** */\r\n/* global Reflect, Promise */\r\n\r\nvar extendStatics = function(d, b) {\r\n    extendStatics = Object.setPrototypeOf ||\r\n        ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n        function (d, b) { for (var p in b) if (Object.prototype.hasOwnProperty.call(b, p)) d[p] = b[p]; };\r\n    return extendStatics(d, b);\r\n};\r\n\r\nexport function __extends(d, b) {\r\n    if (typeof b !== \"function\" && b !== null)\r\n        throw new TypeError(\"Class extends value \" + String(b) + \" is not a constructor or null\");\r\n    extendStatics(d, b);\r\n    function __() { this.constructor = d; }\r\n    d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n}\r\n\r\nexport var __assign = function() {\r\n    __assign = Object.assign || function __assign(t) {\r\n        for (var s, i = 1, n = arguments.length; i < n; i++) {\r\n            s = arguments[i];\r\n            for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p)) t[p] = s[p];\r\n        }\r\n        return t;\r\n    }\r\n    return __assign.apply(this, arguments);\r\n}\r\n\r\nexport function __rest(s, e) {\r\n    var t = {};\r\n    for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p) && e.indexOf(p) < 0)\r\n        t[p] = s[p];\r\n    if (s != null && typeof Object.getOwnPropertySymbols === \"function\")\r\n        for (var i = 0, p = Object.getOwnPropertySymbols(s); i < p.length; i++) {\r\n            if (e.indexOf(p[i]) < 0 && Object.prototype.propertyIsEnumerable.call(s, p[i]))\r\n                t[p[i]] = s[p[i]];\r\n        }\r\n    return t;\r\n}\r\n\r\nexport function __decorate(decorators, target, key, desc) {\r\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\r\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\r\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\r\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\r\n}\r\n\r\nexport function __param(paramIndex, decorator) {\r\n    return function (target, key) { decorator(target, key, paramIndex); }\r\n}\r\n\r\nexport function __metadata(metadataKey, metadataValue) {\r\n    if (typeof Reflect === \"object\" && typeof Reflect.metadata === \"function\") return Reflect.metadata(metadataKey, metadataValue);\r\n}\r\n\r\nexport function __awaiter(thisArg, _arguments, P, generator) {\r\n    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }\r\n    return new (P || (P = Promise))(function (resolve, reject) {\r\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\r\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\r\n        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }\r\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\r\n    });\r\n}\r\n\r\nexport function __generator(thisArg, body) {\r\n    var _ = { label: 0, sent: function() { if (t[0] & 1) throw t[1]; return t[1]; }, trys: [], ops: [] }, f, y, t, g;\r\n    return g = { next: verb(0), \"throw\": verb(1), \"return\": verb(2) }, typeof Symbol === \"function\" && (g[Symbol.iterator] = function() { return this; }), g;\r\n    function verb(n) { return function (v) { return step([n, v]); }; }\r\n    function step(op) {\r\n        if (f) throw new TypeError(\"Generator is already executing.\");\r\n        while (_) try {\r\n            if (f = 1, y && (t = op[0] & 2 ? y[\"return\"] : op[0] ? y[\"throw\"] || ((t = y[\"return\"]) && t.call(y), 0) : y.next) && !(t = t.call(y, op[1])).done) return t;\r\n            if (y = 0, t) op = [op[0] & 2, t.value];\r\n            switch (op[0]) {\r\n                case 0: case 1: t = op; break;\r\n                case 4: _.label++; return { value: op[1], done: false };\r\n                case 5: _.label++; y = op[1]; op = [0]; continue;\r\n                case 7: op = _.ops.pop(); _.trys.pop(); continue;\r\n                default:\r\n                    if (!(t = _.trys, t = t.length > 0 && t[t.length - 1]) && (op[0] === 6 || op[0] === 2)) { _ = 0; continue; }\r\n                    if (op[0] === 3 && (!t || (op[1] > t[0] && op[1] < t[3]))) { _.label = op[1]; break; }\r\n                    if (op[0] === 6 && _.label < t[1]) { _.label = t[1]; t = op; break; }\r\n                    if (t && _.label < t[2]) { _.label = t[2]; _.ops.push(op); break; }\r\n                    if (t[2]) _.ops.pop();\r\n                    _.trys.pop(); continue;\r\n            }\r\n            op = body.call(thisArg, _);\r\n        } catch (e) { op = [6, e]; y = 0; } finally { f = t = 0; }\r\n        if (op[0] & 5) throw op[1]; return { value: op[0] ? op[1] : void 0, done: true };\r\n    }\r\n}\r\n\r\nexport var __createBinding = Object.create ? (function(o, m, k, k2) {\r\n    if (k2 === undefined) k2 = k;\r\n    Object.defineProperty(o, k2, { enumerable: true, get: function() { return m[k]; } });\r\n}) : (function(o, m, k, k2) {\r\n    if (k2 === undefined) k2 = k;\r\n    o[k2] = m[k];\r\n});\r\n\r\nexport function __exportStar(m, o) {\r\n    for (var p in m) if (p !== \"default\" && !Object.prototype.hasOwnProperty.call(o, p)) __createBinding(o, m, p);\r\n}\r\n\r\nexport function __values(o) {\r\n    var s = typeof Symbol === \"function\" && Symbol.iterator, m = s && o[s], i = 0;\r\n    if (m) return m.call(o);\r\n    if (o && typeof o.length === \"number\") return {\r\n        next: function () {\r\n            if (o && i >= o.length) o = void 0;\r\n            return { value: o && o[i++], done: !o };\r\n        }\r\n    };\r\n    throw new TypeError(s ? \"Object is not iterable.\" : \"Symbol.iterator is not defined.\");\r\n}\r\n\r\nexport function __read(o, n) {\r\n    var m = typeof Symbol === \"function\" && o[Symbol.iterator];\r\n    if (!m) return o;\r\n    var i = m.call(o), r, ar = [], e;\r\n    try {\r\n        while ((n === void 0 || n-- > 0) && !(r = i.next()).done) ar.push(r.value);\r\n    }\r\n    catch (error) { e = { error: error }; }\r\n    finally {\r\n        try {\r\n            if (r && !r.done && (m = i[\"return\"])) m.call(i);\r\n        }\r\n        finally { if (e) throw e.error; }\r\n    }\r\n    return ar;\r\n}\r\n\r\n/** @deprecated */\r\nexport function __spread() {\r\n    for (var ar = [], i = 0; i < arguments.length; i++)\r\n        ar = ar.concat(__read(arguments[i]));\r\n    return ar;\r\n}\r\n\r\n/** @deprecated */\r\nexport function __spreadArrays() {\r\n    for (var s = 0, i = 0, il = arguments.length; i < il; i++) s += arguments[i].length;\r\n    for (var r = Array(s), k = 0, i = 0; i < il; i++)\r\n        for (var a = arguments[i], j = 0, jl = a.length; j < jl; j++, k++)\r\n            r[k] = a[j];\r\n    return r;\r\n}\r\n\r\nexport function __spreadArray(to, from) {\r\n    for (var i = 0, il = from.length, j = to.length; i < il; i++, j++)\r\n        to[j] = from[i];\r\n    return to;\r\n}\r\n\r\nexport function __await(v) {\r\n    return this instanceof __await ? (this.v = v, this) : new __await(v);\r\n}\r\n\r\nexport function __asyncGenerator(thisArg, _arguments, generator) {\r\n    if (!Symbol.asyncIterator) throw new TypeError(\"Symbol.asyncIterator is not defined.\");\r\n    var g = generator.apply(thisArg, _arguments || []), i, q = [];\r\n    return i = {}, verb(\"next\"), verb(\"throw\"), verb(\"return\"), i[Symbol.asyncIterator] = function () { return this; }, i;\r\n    function verb(n) { if (g[n]) i[n] = function (v) { return new Promise(function (a, b) { q.push([n, v, a, b]) > 1 || resume(n, v); }); }; }\r\n    function resume(n, v) { try { step(g[n](v)); } catch (e) { settle(q[0][3], e); } }\r\n    function step(r) { r.value instanceof __await ? Promise.resolve(r.value.v).then(fulfill, reject) : settle(q[0][2], r); }\r\n    function fulfill(value) { resume(\"next\", value); }\r\n    function reject(value) { resume(\"throw\", value); }\r\n    function settle(f, v) { if (f(v), q.shift(), q.length) resume(q[0][0], q[0][1]); }\r\n}\r\n\r\nexport function __asyncDelegator(o) {\r\n    var i, p;\r\n    return i = {}, verb(\"next\"), verb(\"throw\", function (e) { throw e; }), verb(\"return\"), i[Symbol.iterator] = function () { return this; }, i;\r\n    function verb(n, f) { i[n] = o[n] ? function (v) { return (p = !p) ? { value: __await(o[n](v)), done: n === \"return\" } : f ? f(v) : v; } : f; }\r\n}\r\n\r\nexport function __asyncValues(o) {\r\n    if (!Symbol.asyncIterator) throw new TypeError(\"Symbol.asyncIterator is not defined.\");\r\n    var m = o[Symbol.asyncIterator], i;\r\n    return m ? m.call(o) : (o = typeof __values === \"function\" ? __values(o) : o[Symbol.iterator](), i = {}, verb(\"next\"), verb(\"throw\"), verb(\"return\"), i[Symbol.asyncIterator] = function () { return this; }, i);\r\n    function verb(n) { i[n] = o[n] && function (v) { return new Promise(function (resolve, reject) { v = o[n](v), settle(resolve, reject, v.done, v.value); }); }; }\r\n    function settle(resolve, reject, d, v) { Promise.resolve(v).then(function(v) { resolve({ value: v, done: d }); }, reject); }\r\n}\r\n\r\nexport function __makeTemplateObject(cooked, raw) {\r\n    if (Object.defineProperty) { Object.defineProperty(cooked, \"raw\", { value: raw }); } else { cooked.raw = raw; }\r\n    return cooked;\r\n};\r\n\r\nvar __setModuleDefault = Object.create ? (function(o, v) {\r\n    Object.defineProperty(o, \"default\", { enumerable: true, value: v });\r\n}) : function(o, v) {\r\n    o[\"default\"] = v;\r\n};\r\n\r\nexport function __importStar(mod) {\r\n    if (mod && mod.__esModule) return mod;\r\n    var result = {};\r\n    if (mod != null) for (var k in mod) if (k !== \"default\" && Object.prototype.hasOwnProperty.call(mod, k)) __createBinding(result, mod, k);\r\n    __setModuleDefault(result, mod);\r\n    return result;\r\n}\r\n\r\nexport function __importDefault(mod) {\r\n    return (mod && mod.__esModule) ? mod : { default: mod };\r\n}\r\n\r\nexport function __classPrivateFieldGet(receiver, state, kind, f) {\r\n    if (kind === \"a\" && !f) throw new TypeError(\"Private accessor was defined without a getter\");\r\n    if (typeof state === \"function\" ? receiver !== state || !f : !state.has(receiver)) throw new TypeError(\"Cannot read private member from an object whose class did not declare it\");\r\n    return kind === \"m\" ? f : kind === \"a\" ? f.call(receiver) : f ? f.value : state.get(receiver);\r\n}\r\n\r\nexport function __classPrivateFieldSet(receiver, state, value, kind, f) {\r\n    if (kind === \"m\") throw new TypeError(\"Private method is not writable\");\r\n    if (kind === \"a\" && !f) throw new TypeError(\"Private accessor was defined without a setter\");\r\n    if (typeof state === \"function\" ? receiver !== state || !f : !state.has(receiver)) throw new TypeError(\"Cannot write private member to an object whose class did not declare it\");\r\n    return (kind === \"a\" ? f.call(receiver, value) : f ? f.value = value : state.set(receiver, value)), value;\r\n}\r\n","import { Injectable } from '@angular/core';\r\nimport * as jwtDecode_ from 'jwt-decode';\r\n\r\nconst jwtDecode = jwtDecode_;\r\n@Injectable()\r\nexport class StorageService {\r\n\r\n  // Storage keys\r\n  private TRANSACTION_ID = 'TRANSACTION_ID';\r\n  private VIP_TOKEN = 'VIP_TOKEN';\r\n  private AZURE_INSTANCE = 'AZURE_INSTANCE';\r\n  private LAST_LOCATION = 'LAST_LOCATION';\r\n\r\n  constructor() { }\r\n\r\n  // VIP TOKEN\r\n  public storeVipToken(token: string) {\r\n    localStorage.setItem(this.VIP_TOKEN, token);\r\n  }\r\n  public retrieveVipToken() {\r\n    return localStorage.getItem(this.VIP_TOKEN);\r\n  }\r\n  public clearVipToken() {\r\n    localStorage.removeItem(this.VIP_TOKEN);\r\n  }\r\n\r\n  // LAST LAST_LOCATION\r\n  public storeLastLocation() {\r\n    const location = `${window.location.pathname}${window.location.search}`;\r\n    console.debug('### Storing last location:');\r\n    console.debug(window.location);\r\n    console.debug('### location = ' + location);\r\n    localStorage.setItem(this.LAST_LOCATION, location);\r\n  }\r\n  public retrieveLastLocation(): string {\r\n    console.debug(`### Retrieving last location: ${localStorage.getItem(this.LAST_LOCATION)}`);\r\n    return localStorage.getItem(this.LAST_LOCATION);\r\n  }\r\n  public clearLastLocation() {\r\n    console.debug('### Clearing the last location');\r\n    localStorage.removeItem(this.LAST_LOCATION);\r\n  }\r\n\r\n  // TRANSACTION ID\r\n  public storeTransactionId(token: string) {\r\n    localStorage.setItem(this.TRANSACTION_ID, token);\r\n  }\r\n\r\n  public retrieveTransactionId() {\r\n    return localStorage.getItem(this.TRANSACTION_ID);\r\n  }\r\n\r\n  public clearTransactionId() {\r\n    localStorage.removeItem(this.TRANSACTION_ID);\r\n  }\r\n\r\n  // AZURE INSTANCE\r\n  public storeAzureInstance(instance: number) {\r\n    localStorage.setItem(this.AZURE_INSTANCE, instance.toString());\r\n  }\r\n\r\n  public retrieveAzureInstance(): number {\r\n    return parseInt(localStorage.getItem(this.AZURE_INSTANCE), 10);\r\n  }\r\n\r\n  public retrieveAzureTenantId(): string {\r\n    const azureToken = localStorage.getItem('adal.idtoken');\r\n    if (azureToken) {\r\n      const decodedToken = jwtDecode(azureToken) as any;\r\n      // tslint:disable-next-line: no-string-literal\r\n      return decodedToken['tid'] as string;\r\n    } else {\r\n      return null;\r\n    }\r\n  }\r\n\r\n  public clearAzureInstance() {\r\n    localStorage.removeItem(this.AZURE_INSTANCE);\r\n  }\r\n}\r\n","import { Injectable } from '@angular/core';\r\nimport { AdalService } from 'adal-angular4';\r\nimport { StorageService } from './storage.service';\r\nimport { NswhpAuthService } from '../nswhpauth.service';\r\n\r\n@Injectable({\r\n  providedIn: 'root'\r\n})\r\nexport class AadService {\r\n  static readonly AZURE_AD_INSTANCE = 0;\r\n  static readonly AZURE_B2C_INSTANCE = 1; // Not used because the app only supports Health AD Logins.\r\n\r\n  /** The index of the adalConfig to use set by clicking the login buttons or through the route parameter */\r\n  public configIndex: number;\r\n  // Adal configs\r\n  private adalConfigs: adal.Config[];\r\n\r\n  /** Takes an integer and returns true if it is in a valid range for the config array */\r\n  public isValidAdalConfigIndex(index: number) {\r\n    return index !== null && index >= 0 && index < this.adalConfigs.length;\r\n  }\r\n\r\n  constructor(\r\n    private adalService: AdalService,\r\n    private storage: StorageService,\r\n    private nswhpAuthService: NswhpAuthService\r\n  ) {\r\n    this.adalConfigs = this.nswhpAuthService.nswhpAuthOptions.adalConfig;\r\n  }\r\n\r\n  /**\r\n   * initialises the Adal service with the config specified by configIndex\r\n   * @param configIndex - Determines which config will be selected, used as an index on `this.adalConfigs`\r\n   * @example\r\n   * if (aadService.isValidAdalConfigIndex(index)) {\r\n   *     intialiseAdalServiceWithConfig(index);\r\n   * }\r\n   */\r\n  public initialiseAdalServiceWithConfig(configIndex: number) {\r\n    if (!this.isValidAdalConfigIndex(configIndex)) {\r\n      throw new Error('ConfigIndex out of bounds. Consider checking with the isValidAdalConfigIndex helper method before calling.');\r\n    }\r\n\r\n    console.debug(`Initialising adal4Service with config index: ` + configIndex);\r\n\r\n    const config = this.adalConfigs[configIndex];\r\n    console.debug(`Adal config: `);\r\n    console.debug('- tenant: ' + config.tenant);\r\n    console.debug('- clientId: ' + config.clientId);\r\n\r\n    this.adalService.init(this.adalConfigs[configIndex]);\r\n\r\n    console.debug('>>>>>>> Actual config after init:');\r\n    console.debug(this.adalService.config);\r\n  }\r\n\r\n  /**\r\n   * Each AD token contains its tenant. Given a token, the tenant can be\r\n   * extracted and passed into getConfigIndexByTenant which will return the\r\n   * config index for that tenant\r\n   */\r\n  public getConfigIndexByTenant(tenant: string) {\r\n    if (tenant === this.adalConfigs[0].tenant) {\r\n      return 0;\r\n    }\r\n\r\n    throw Error(`Unknown tenant passed in: ${tenant}`);\r\n  }\r\n\r\n  public handleWindowCallbackFromAzureLogin() {\r\n    this.adalService.handleWindowCallback();\r\n  }\r\n\r\n  public loginToAzure() {\r\n    // Whenever the user gets a new AAD token we clear any existing VIP token\r\n    // TODO: Why do we need to clear the VIP token, does this really make sense?\r\n    this.storage.clearVipToken();\r\n    this.storage.clearTransactionId();\r\n\r\n    this.adalService.login();\r\n  }\r\n\r\n  public logoutOfAzure() {\r\n    // Delete the user's Azure instance selection when they logout\r\n    this.storage.clearAzureInstance();\r\n\r\n    this.adalService.logOut();\r\n  }\r\n\r\n  public retrieveAadToken(): string {\r\n    return this.adalService.userInfo.token;\r\n  }\r\n}\r\n","import { Component, OnInit } from '@angular/core';\r\nimport { ActivatedRoute, Router } from '@angular/router';\r\n\r\nimport { AadService } from '../../services/aad.service';\r\nimport { StorageService } from '../../services/storage.service';\r\n\r\n@Component({\r\n  selector: 'lib-azure-login',\r\n  templateUrl: './azure-login.component.html',\r\n  styleUrls: ['./azure-login.component.css', '../../main.css']\r\n})\r\nexport class AzureLoginComponent implements OnInit {\r\n\r\n  public readonly azureInstanceAD = 'NSW Health Employee';\r\n\r\n  constructor(\r\n    private aadService: AadService,\r\n    private router: Router,\r\n    private activatedRoute: ActivatedRoute,\r\n    private storage: StorageService\r\n  ) { }\r\n\r\n  private async handleLoginRouting() {\r\n    const routeParams = this.activatedRoute.snapshot.params.tenantConfigId as number | null;\r\n\r\n    // If we're returning from a login, initialise ADAL with the supplied config index\r\n    if (routeParams) {\r\n      this.aadService.initialiseAdalServiceWithConfig(routeParams);\r\n      this.aadService.handleWindowCallbackFromAzureLogin();\r\n\r\n      const lastLocation = this.storage.retrieveLastLocation();\r\n      this.storage.clearLastLocation();\r\n\r\n      if (lastLocation) {\r\n        // Use href to simplify the process of restoring and routing\r\n        // route parameters and query parameters\r\n        // When we return from a 401 back to a route that has query params\r\n        // e.g. the Diagnostic Report screen, we want those query params\r\n        // to be included\r\n        window.location.href = lastLocation;\r\n      } else {\r\n        await this.router.navigate(['']);\r\n      }\r\n    } else {\r\n      // there is only one login for this app, just pick it\r\n      this.selectAzureInstance(this.azureInstanceAD);\r\n    }\r\n  }\r\n\r\n  async ngOnInit() {\r\n    console.debug('LOGIN onInit');\r\n    await this.handleLoginRouting();\r\n  }\r\n\r\n  public selectAzureInstance(instance: string) {\r\n    console.debug('Selecting Azure instance: ' + instance);\r\n\r\n    // Whilst this is redundant (because we will only ever pass in `this.azureInstanceAD`)\r\n    // We want to keep the structure of the ADAL initialisation the same as the base PoC\r\n    // from when there were multiple ADs\r\n    if (instance === this.azureInstanceAD) {\r\n      this.aadService.initialiseAdalServiceWithConfig(AadService.AZURE_AD_INSTANCE);\r\n    }\r\n\r\n    // Log the user into the selected Azure instance\r\n    // When Azure responds, it will have the tenantConfig of 0 which will\r\n    // then route the user to their last window location in the constructor above.\r\n    this.aadService.loginToAzure();\r\n  }\r\n}\r\n","import { Component, OnInit } from '@angular/core';\r\nimport { AadService } from '../../services/aad.service';\r\n\r\n@Component({\r\n  template: '',\r\n  selector: 'lib-azure-logout'\r\n})\r\nexport class AzureLogoutComponent implements OnInit {\r\n  constructor(private aadService: AadService) { }\r\n\r\n  ngOnInit() {\r\n    this.aadService.logoutOfAzure();\r\n  }\r\n}\r\n","import { Component, OnInit } from '@angular/core';\r\nimport { Router } from '@angular/router';\r\n\r\n@Component({\r\n  selector: 'lib-contact-admin',\r\n  templateUrl: './contact-admin.component.html',\r\n  styleUrls: ['./contact-admin.component.scss', '../../main.css']\r\n})\r\nexport class ContactAdminComponent {\r\n\r\n  public readonly email: string = 'NSWPATH-TestCatalogue@health.nsw.gov.au';\r\n  public readonly subject: string = 'Requesting Access to the Statewide Test Catalogue';\r\n  public readonly href: string = `mailto:${this.email}?subject=${this.subject}`;\r\n  constructor(private readonly router: Router) { }\r\n\r\n  public async redirect() {\r\n    await this.router.navigate(['authentication/login']);\r\n  }\r\n}\r\n","import { Injectable } from '@angular/core';\r\n\r\n// Semantics Device Fingerprint library\r\ndeclare var IaDfp: any;\r\n\r\n@Injectable()\r\nexport class IaDfpService {\r\n  public readonly IaDfp = IaDfp;\r\n\r\n  constructor() { }\r\n}\r\n","import { HttpClient, HttpErrorResponse } from '@angular/common/http';\r\nimport { Injectable } from '@angular/core';\r\nimport { Router } from '@angular/router';\r\nimport { EMPTY, Observable, throwError } from 'rxjs';\r\nimport { catchError, map, tap } from 'rxjs/operators';\r\n\r\nimport { IMfaMessage } from '../model/mfaMessage';\r\nimport { NswhpAuthService } from '../nswhpauth.service';\r\nimport { IaDfpService } from './iadfp.service';\r\nimport { StorageService } from './storage.service';\r\n\r\n// Semantics Device Fingerprint library\r\n@Injectable()\r\nexport class VipService {\r\n  private pushUrl: string;\r\n  private otpUrl: string;\r\n  private sendOtpUrl: string;\r\n  private registerUrl: string;\r\n\r\n  constructor(\r\n    private http: HttpClient,\r\n    private router: Router,\r\n    private storage: StorageService,\r\n    private iaDfpService: IaDfpService,\r\n    private nswhpAuthService: NswhpAuthService\r\n  ) {\r\n    this.pushUrl = this.nswhpAuthService.nswhpAuthOptions.adal.pushUrl;\r\n    this.otpUrl = this.nswhpAuthService.nswhpAuthOptions.adal.otpUrl;\r\n    this.sendOtpUrl = this.nswhpAuthService.nswhpAuthOptions.adal.sendOtpUrl;\r\n    this.registerUrl = this.nswhpAuthService.nswhpAuthOptions.adal.registerUrl;\r\n  }\r\n\r\n\r\n  /* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * *\r\n   *                                 PUSH                                  *\r\n   * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * */\r\n\r\n  // Wait for user to accept push notification\r\n  public pollUsersPushResponse(): Observable<IMfaMessage> {\r\n    console.debug('Authenticating user with PUSH...');\r\n\r\n    const body = JSON.stringify({ transactionId: this.storage.retrieveTransactionId() });\r\n    console.debug('TRANSACTION ID = ' + this.storage.retrieveTransactionId());\r\n\r\n    return this.http.post<IMfaMessage>(this.pushUrl, body)\r\n      .pipe(map(res => this.extractData(res)))\r\n      .pipe(catchError(this.handleError.bind(this)));\r\n  }\r\n\r\n\r\n  /* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * *\r\n   *                                 OTP                                   *\r\n   * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * */\r\n\r\n  // Send otp code for authentication\r\n  public authenticateOtpCode(otpCode: string): Observable<IMfaMessage> {\r\n    console.debug('Authenticating user with OTP...');\r\n\r\n    const newDeviceFingerprint = this.getDeviceFingerprint();\r\n    const body = {\r\n      deviceFingerprint: newDeviceFingerprint,\r\n      otp: otpCode\r\n    };\r\n\r\n    return this.http.post<IMfaMessage>(this.otpUrl, body)\r\n      .pipe(map(res => this.extractData(res)))\r\n      .pipe(catchError(this.handleError.bind(this)));\r\n  }\r\n\r\n\r\n  /* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * *\r\n   *                            REGISTRATION                               *\r\n   * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * */\r\n\r\n  // Send the user a SMS OTP code for registration\r\n  public sendOtpForRegistration() {\r\n    console.debug('Creating VIP Account and sending user SMS OTP code...');\r\n\r\n    const newDeviceFingerprint = this.getDeviceFingerprint();\r\n    const body = {\r\n      deviceFingerprint: newDeviceFingerprint\r\n    };\r\n\r\n    return this.http.post<IMfaMessage>(this.sendOtpUrl, body)\r\n      .pipe(map(res => this.extractData(res)))\r\n      .pipe(catchError(this.handleError.bind(this)));\r\n  }\r\n\r\n  // Send user information for VIP registration\r\n  public submitVipRegistration(newCredentialId: string, newOtp1: string, newOtp2: string, newTempOtp: string) {\r\n    console.debug('Submitting user\\'s VIP registration...');\r\n\r\n    const newDeviceFingerprint = this.getDeviceFingerprint();\r\n    const body = {\r\n      deviceFingerprint: newDeviceFingerprint,\r\n      credentialId: newCredentialId,\r\n      otp1: newOtp1,\r\n      otp2: newOtp2,\r\n      tempOtp: newTempOtp\r\n    };\r\n\r\n    console.debug('Device fingerprint: ' + newDeviceFingerprint);\r\n    console.debug('Credential ID: ' + newCredentialId);\r\n    console.debug('First security code: ' + newOtp1);\r\n    console.debug('Second security code: ' + newOtp2);\r\n    console.debug('SMS Code: ' + newTempOtp);\r\n\r\n    return this.http.post<IMfaMessage>(this.registerUrl, body)\r\n      .pipe(\r\n        tap(res => this.extractData(res),\r\n          catchError(this.handleError.bind(this)))\r\n      );\r\n  }\r\n\r\n  // Return to the last location the user made a http request and got a 401\r\n  public redirectToLastLocation() {\r\n    console.debug('### VIP SERVICE: redirectToLastLocation');\r\n    const lastLocation = this.storage.retrieveLastLocation();\r\n    this.storage.clearLastLocation();\r\n    if (lastLocation) {\r\n      console.debug('### We HAVE just returned from handling a 401 error. Redirecting to... ' + lastLocation);\r\n\r\n      this.storage.clearLastLocation();\r\n      // Use hreft to simplify the process of restoring and routing\r\n      // route parameters and query parameters\r\n      window.location.href = lastLocation;\r\n    } else {\r\n      console.debug('### We have NOT returned from handling a 401 error');\r\n    }\r\n\r\n  }\r\n\r\n\r\n  /* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * */\r\n\r\n  private getDeviceFingerprint() {\r\n    return this.iaDfpService.IaDfp.readFingerprint();\r\n  }\r\n\r\n  private extractData(res: IMfaMessage) {\r\n    console.debug('>>> VIP SERVICE: ');\r\n    console.debug(res);\r\n\r\n    // Store the Vip token if returned here so the components don't have to think about it\r\n    if (res.vipToken) {\r\n      this.storage.storeVipToken(res.vipToken);\r\n    }\r\n\r\n    return res;\r\n  }\r\n\r\n  /**\r\n   * If the error is a 403 navigate to the Contact Admin page, otherwise bubble\r\n   * the error up\r\n   */\r\n  private async handleError(error: HttpErrorResponse) {\r\n    // 403 Forbidden - Require Admin\r\n    if (error.status === 403) {\r\n      await this.handleContactAdmin(error);\r\n      return EMPTY;\r\n    } else {\r\n      return throwError(error);\r\n    }\r\n  }\r\n\r\n  private async handleContactAdmin(error: HttpErrorResponse) {\r\n    console.debug('Handling Operation Not Allowed');\r\n    console.debug('User is unable to continue authorization process.');\r\n    console.debug(error.error.detailMessage);\r\n    console.debug('Redirecting user to contact admin page...');\r\n\r\n    // To be implemented under DT-1138\r\n    await this.router.navigate(['/authentication/contact-admin/' + error.error.requestId]);\r\n  }\r\n}\r\n","import { Component, OnInit } from '@angular/core';\r\nimport { VipService } from '../../services/vip.service';\r\nimport { IMfaMessage } from '../../model/mfaMessage';\r\n\r\n@Component({\r\n  selector: 'lib-otp',\r\n  templateUrl: './otp.component.html',\r\n  styleUrls: ['./otp.component.scss', '../../main.css']\r\n})\r\nexport class OtpComponent implements OnInit {\r\n\r\n  submitted = false;\r\n  authenticated = false;\r\n  failed = false;\r\n\r\n  submitButtonText = 'Submit';\r\n\r\n  constructor(\r\n    private vipService: VipService,\r\n  ) { }\r\n\r\n  ngOnInit() {\r\n  }\r\n\r\n  onSubmit(code: string): false {\r\n\r\n    if (!this.submitted) {\r\n      this.submitted = true;\r\n      this.submitButtonText = 'Submitting...';\r\n\r\n      this.vipService.authenticateOtpCode(code).subscribe(\r\n        response => { this.handleSuccessfulOtpAuthentication(response); },\r\n        () => { this.handleFailedOtpAuthentication(); }\r\n      );\r\n    }\r\n\r\n    return false; // Don't cause a reload\r\n  }\r\n\r\n  private handleSuccessfulOtpAuthentication(response: IMfaMessage) {\r\n    console.debug(response);\r\n\r\n    this.authenticated = true;\r\n    this.failed = false;\r\n\r\n    // NOTE: VipService intercepts the response and stores the Vip token\r\n\r\n    this.vipService.redirectToLastLocation();\r\n  }\r\n\r\n  private handleFailedOtpAuthentication() {\r\n    this.submitted = false;\r\n    this.failed = true;\r\n    this.submitButtonText = 'Try Again';\r\n  }\r\n\r\n  // Turn the input green again when the user starts changing the otp code\r\n  public enteringOtp() {\r\n    this.failed = false;\r\n  }\r\n}\r\n","import { HttpErrorResponse } from '@angular/common/http';\r\nimport { Component, OnInit } from '@angular/core';\r\nimport { Router } from '@angular/router';\r\n\r\nimport { IMfaMessageErrorMessage } from '../../model/mfaErrorMessage';\r\nimport { IMfaMessage } from '../../model/mfaMessage';\r\nimport { VipService } from '../../services/vip.service';\r\n\r\n@Component({\r\n  selector: 'lib-push',\r\n  templateUrl: './push.component.html',\r\n  styleUrls: ['./push.component.scss', '../../main.css']\r\n})\r\nexport class PushComponent implements OnInit {\r\n\r\n  waiting: boolean;\r\n  public success: boolean;\r\n\r\n  public statusMessage = '';\r\n  public detailMessage = '';\r\n\r\n  constructor(\r\n    private router: Router,\r\n    private vipService: VipService\r\n  ) { }\r\n\r\n  ngOnInit() {\r\n\r\n    // Call API and wait for response\r\n    this.waiting = true;\r\n\r\n    this.vipService.pollUsersPushResponse().subscribe(\r\n      response => {\r\n        this.handleSuccessfulPush(response);\r\n      },\r\n      error => {\r\n        this.handleFailedPush(error);\r\n      }\r\n    );\r\n  }\r\n\r\n  private handleSuccessfulPush(response: IMfaMessage) {\r\n    console.debug('SUCCESS: User accepted push notification');\r\n    console.debug('vipToken: ' + response.vipToken);\r\n    console.debug(response);\r\n\r\n    // Hide the waiting screen and show success!\r\n    this.waiting = false;\r\n    this.success = true;\r\n\r\n    this.statusMessage = response.statusMessage;\r\n    this.detailMessage = response.detailMessage;\r\n\r\n    // NOTE: VipService intercepts the response and stores the Vip token\r\n\r\n    this.vipService.redirectToLastLocation();\r\n  }\r\n\r\n  private handleFailedPush(error: HttpErrorResponse) {\r\n    console.debug('ERROR: Did not receive user\\'s push acceptance');\r\n    console.error(error);\r\n    console.error(error.error);\r\n\r\n    // Hide the waiting screen and show failure!\r\n    this.waiting = false;\r\n    this.success = false;\r\n\r\n    const err = error.error as IMfaMessageErrorMessage;\r\n\r\n    this.statusMessage = err.statusMessage;\r\n    this.detailMessage = err.detailMessage;\r\n  }\r\n\r\n\r\n  public async useOTP() {\r\n    console.debug('User has selected to use OTP instead of Push. Redirecting...');\r\n    await this.router.navigate(['authentication/otp']);\r\n  }\r\n}\r\n","import { Component, OnInit } from '@angular/core';\r\nimport { Router } from '@angular/router';\r\n\r\nimport { IMfaMessage } from '../../model/mfaMessage';\r\nimport { VipHttpErrorResonse } from '../../model/vipHttpErrorResponse';\r\nimport { VipService } from '../../services/vip.service';\r\n\r\n@Component({\r\n  selector: 'lib-register',\r\n  templateUrl: './register.component.html',\r\n  styleUrls: ['./register.component.scss', '../../main.css']\r\n})\r\nexport class RegisterComponent implements OnInit {\r\n\r\n  smsCodeSent = false;\r\n  registered = false;\r\n  failed = false;\r\n\r\n  statusMessage = '';\r\n  submitButtonText = 'Register';\r\n\r\n  mobileNumber = '';\r\n  invalidInputMessage = '';\r\n\r\n  // Input values\r\n  credentialIdValue = '';\r\n  otp1Value = '';\r\n  otp2Value = '';\r\n  tempOtpValue = '';\r\n\r\n  // Store the valid flag for each input in the form\r\n  validInputs = [true, true, true, true];\r\n  CREDENTIAL_ID = 0;\r\n  OTP_1 = 1;\r\n  OTP_2 = 2;\r\n  TEMP_OTP = 3;\r\n\r\n  constructor(\r\n    private router: Router,\r\n    private vipService: VipService\r\n  ) { }\r\n\r\n  ngOnInit() {\r\n\r\n    // Send SMS OTP code for registration\r\n    this.initiateRegistrationProcess();\r\n  }\r\n\r\n  private initiateRegistrationProcess() {\r\n    this.smsCodeSent = false;\r\n    this.validInputs = [true, true, true, true];\r\n\r\n    this.vipService.sendOtpForRegistration().subscribe(\r\n      response => {\r\n        console.debug(response);\r\n        this.smsCodeSent = true;\r\n        this.mobileNumber = response.mobileNumber;\r\n      },\r\n      async error => {\r\n        console.debug('Error sending SMS code to user for registration...');\r\n        console.debug(error);\r\n\r\n        // TODO: Do we want to handle better\r\n        // We need to pass in the request id to the page\r\n        await this.router.navigate(['/authentication/contact-admin']);\r\n      }\r\n    );\r\n  }\r\n\r\n  onSubmit(credentialId: string, otp1: string, otp2: string, tempOtp: string): false {\r\n\r\n    if (this.allInputsValid(credentialId, otp1, otp2, tempOtp)) {\r\n      this.submitButtonText = 'Registering...';\r\n      this.vipService.submitVipRegistration(credentialId, otp1, otp2, tempOtp).subscribe(\r\n        response => { this.handleSuccessfulRegistration(response); },\r\n        error => { this.handleFailedRegistration(error); }\r\n      );\r\n    }\r\n\r\n    return false; // Don't cause a reload\r\n  }\r\n\r\n  handleSuccessfulRegistration(response: IMfaMessage) {\r\n    console.debug('SUCCESS: User registered with VIP');\r\n    console.debug('vipToken: ' + response.vipToken);\r\n    console.debug(response);\r\n\r\n    // Notify the user of successful registration and show home button\r\n    this.registered = true;\r\n    this.failed = false;\r\n    this.statusMessage = response.statusMessage;\r\n\r\n    // NOTE: VipService intercepts the response and stores the Vip token\r\n    this.vipService.redirectToLastLocation();\r\n  }\r\n\r\n  // If registration fails for any reason (we assume all inputs passed validation - even though current validation is minimal)\r\n  // we will send a new SMS code and clear all inputs so user can begin registration process again\r\n  private handleFailedRegistration(error: VipHttpErrorResonse) {\r\n    console.debug('ERROR: Failed to register user with VIP');\r\n    console.debug(error);\r\n\r\n    this.failed = true;\r\n\r\n    // Clear all inputs\r\n    this.credentialIdValue = null;\r\n    this.otp1Value = null;\r\n    this.otp2Value = null;\r\n    this.tempOtpValue = null;\r\n\r\n    // Tell user to try again with new SMS code\r\n    this.submitButtonText = 'Try Again';\r\n\r\n    this.initiateRegistrationProcess();\r\n  }\r\n\r\n  /* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * */\r\n\r\n  validateInput(input: HTMLInputElement) {\r\n    console.debug(input);\r\n\r\n    // Assume valid\r\n    this.validInputs[parseInt(input.id, 10)] = true;\r\n    this.invalidInputMessage = '';\r\n\r\n    // No whitespace\r\n    if (/\\s/.test(input.value)) {\r\n      this.validInputs[parseInt(input.id, 10)] = false;\r\n      this.invalidInputMessage = 'Input must not contain spaces';\r\n    }\r\n\r\n    // Only numbers in OTPs\r\n    if (input.id === this.OTP_1.toString() || input.id === this.OTP_2.toString() || input.id === this.TEMP_OTP.toString()) {\r\n      const nums = /^[0-9]*$/;\r\n      if (!input.value.match(nums)) {\r\n        this.validInputs[parseInt(input.id, 10)] = false;\r\n        this.invalidInputMessage = 'Codes may only contains numbers';\r\n      }\r\n    }\r\n\r\n    console.debug(this.validInputs);\r\n  }\r\n\r\n  private allInputsValid(credentialId: string, otp1: string, otp2: string, tempOtp: string): boolean {\r\n\r\n    // Ensure all inputs have been entered\r\n    if (tempOtp.length <= 0) {\r\n      this.validInputs[this.TEMP_OTP] = false;\r\n    }\r\n    if (otp2.length <= 0) {\r\n      this.validInputs[this.OTP_2] = false;\r\n    }\r\n    if (otp1.length <= 0) {\r\n      this.validInputs[this.OTP_1] = false;\r\n    }\r\n    if (credentialId.length <= 0) {\r\n      this.validInputs[this.CREDENTIAL_ID] = false;\r\n    }\r\n\r\n    if (this.validInputs.includes(false)) {\r\n      this.invalidInputMessage = 'Please fill in all fields';\r\n      return false;\r\n    } else {\r\n      this.invalidInputMessage = '';\r\n      return true;\r\n    }\r\n  }\r\n}\r\n","import {\r\n  HttpClient,\r\n  HttpErrorResponse,\r\n  HttpEvent,\r\n  HttpHandler,\r\n  HttpHeaders,\r\n  HttpInterceptor,\r\n  HttpRequest,\r\n  HttpResponse,\r\n} from '@angular/common/http';\r\nimport { Injectable } from '@angular/core';\r\nimport { Router } from '@angular/router';\r\nimport * as HttpStatus from 'http-status-codes';\r\nimport { EMPTY, Observable, throwError } from 'rxjs';\r\nimport { catchError } from 'rxjs/operators';\r\n\r\nimport { IMfaMessage } from '../model/mfaMessage';\r\nimport { VipHttpErrorResonse } from '../model/vipHttpErrorResponse';\r\nimport { NswhpAuthService } from '../nswhpauth.service';\r\nimport { AadService } from './aad.service';\r\nimport { IaDfpService } from './iadfp.service';\r\nimport { StorageService } from './storage.service';\r\n\r\n@Injectable({\r\n  providedIn: 'root'\r\n})\r\nexport class AuthenticationInterceptorService implements HttpInterceptor {\r\n  private AAD_TOKEN_HEADER = 'AuthorizationAD';\r\n  private VIP_TOKEN_HEADER = 'AuthorizationVIP';\r\n  private domain: string;\r\n  private stepUpPath: string;\r\n  constructor(\r\n    private aadService: AadService,\r\n    private storageService: StorageService,\r\n    private router: Router,\r\n    private http: HttpClient,\r\n    private iaDfpService: IaDfpService,\r\n    private nswhpAuthService: NswhpAuthService\r\n  ) {\r\n    this.domain = this.nswhpAuthService.nswhpAuthOptions.vip.domain;\r\n    this.stepUpPath = this.nswhpAuthService.nswhpAuthOptions.vip.stepUpPath;\r\n  }\r\n\r\n  intercept(request: HttpRequest<HttpAuthRequest>, next: HttpHandler): Observable<HttpEvent<any>> {\r\n\r\n    request = this.addAuthHeaders(request);\r\n\r\n    return next.handle(request).pipe(\r\n      catchError(this.handleError.bind(this))\r\n    );\r\n  }\r\n\r\n  public addAuthHeaders(request: HttpRequest<HttpAuthRequest>) {\r\n    const headers: {\r\n      [index: string]: string\r\n    } = {\r\n      'Content-Type': 'application/json',\r\n      'Access-Control-Allow-Origin': '*',\r\n      'Access-Control-Allow-Methods': 'POST, GET, OPTIONS, DELETE',\r\n      'Access-Control-Max-Age': '3600',\r\n      'Access-Control-Allow-Headers': 'x-requested-with'\r\n    };\r\n\r\n    // These have been added separately since string interpolation is not supported for object keys\r\n    const aadToken = this.aadService.retrieveAadToken();\r\n    if (aadToken) {\r\n      headers[this.AAD_TOKEN_HEADER] = aadToken;\r\n    }\r\n\r\n    const vipToken = this.storageService.retrieveVipToken();\r\n    if (vipToken) {\r\n      headers[this.VIP_TOKEN_HEADER] = (vipToken as string);\r\n    }\r\n\r\n    request = request.clone({\r\n      setHeaders: headers\r\n    });\r\n\r\n    return request;\r\n  }\r\n\r\n\r\n  /* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * *\r\n   *                    USER AUTHORIZATION LOGIC [401]                     *\r\n   * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * */\r\n\r\n  // If the user is unable to reach the API endpoint we must ensure they are authenticated.\r\n  // The user is first authenticated with Azure AD\r\n  //     - If the user does not have a valid AAD token we redirect them to login to Azure AD\r\n  // The user is then required to have a VIP token\r\n  //     - The '/stepup' endpoint must be called and then the following may happen:\r\n  //         + If the user is not risky then we are immediately provided with the VIP token\r\n  //         + If the user is risky then they are redirect to the provided MFA medium (push or otp)\r\n  //             = NOTE: If the user is redirect to push or otp they will be redirected\r\n  //                     back home once they have a valid VIP token\r\n  private async handleUserAuthorization(error: HttpErrorResponse) {\r\n    // Store the user context so we can return here after handling the 401\r\n    this.storageService.storeLastLocation();\r\n\r\n    // Check if the user is authenticated with Azure:\r\n    //      If they are, we have a valid AAD Token and we can continue.\r\n    //      If they are not, we redirect them to the Azure login page and leave\r\n    //       them there until they successfully login. They will then be redirected to the home page\r\n    if (this.isNewAadTokenRequired(error)) {\r\n      await this.router.navigate(['authentication/login']);\r\n    } else {\r\n      this.getVipToken();\r\n    }\r\n  }\r\n\r\n  private async handleError(error: HttpErrorResponse) {\r\n    // Handle Unauthorized error globally\r\n    // AuthService will handle other 400 errors\r\n    switch (error.status) {\r\n      case HttpStatus.UNAUTHORIZED:\r\n        console.debug('401 received, redirecting to login');\r\n        await this.handleUserAuthorization(error);\r\n        break;\r\n      case HttpStatus.FORBIDDEN:\r\n        console.debug('403 received in AuthenticationInterceptor, redirecting to contact admin');\r\n        await this.router.navigate(['/authentication/contact-admin']);\r\n        return EMPTY;\r\n      default:\r\n        return throwError(error);\r\n    }\r\n  }\r\n\r\n  /**\r\n   * If the error contains 'VIP' then we assume the AAD token is being successfully used\r\n   * and that the 401 is caused by a missing or invalid VIP token\r\n   * @param HttpErrorResponse returned by the call\r\n   */\r\n  private isNewAadTokenRequired(error: HttpErrorResponse) {\r\n    let required = true;\r\n    const re = /(vip|VIP)/;\r\n    if (error.error.message.search(re) !== -1) {\r\n      required = false;\r\n    }\r\n\r\n    return required;\r\n  }\r\n\r\n\r\n  /* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * *\r\n   *                             VIP TOKEN                                 *\r\n   * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * */\r\n\r\n  /**\r\n   * Initiates the steps to retrieve a VIP token from the server\r\n   */\r\n  private getVipToken() {\r\n    console.debug('Requesting new VIP Token...');\r\n\r\n    this.stepUpAuthentication().subscribe(\r\n      async response => {\r\n        this.logStepUpResponse(response);\r\n        await this.handleStepUpAuthentication(response);\r\n      },\r\n      async error => {\r\n        // NOTE: We specifically handle 403 and 404 errors here\r\n        // Only 401 is handled globally. Other Auth related http calls\r\n        // are made in AuthService that handles the other 400 errors.\r\n\r\n        // Forbidden - Contact an admin (requestId)\r\n        if (error.status === HttpStatus.FORBIDDEN) {\r\n          console.error('403 received');\r\n          // TODO: This\r\n          await this.handleContactAdmin(error);\r\n          return EMPTY;\r\n        } else if (error.status === HttpStatus.NOT_FOUND) {\r\n          console.error('404 received');\r\n          await this.handleRegistration(error);\r\n          return EMPTY;\r\n        } else {\r\n          await this.handleError(error);\r\n        }\r\n      }\r\n    );\r\n  }\r\n\r\n  private stepUpAuthentication(): Observable<HttpResponse<IMfaMessage>> {\r\n    console.debug('User required to step up authentication: ');\r\n\r\n    // We can assume that if we are requesting a VIP token we already have a valid AAD Token\r\n    const authorization = this.aadService.retrieveAadToken();\r\n    const newHeaders = new HttpHeaders().set(this.AAD_TOKEN_HEADER, authorization);\r\n\r\n    const options = {\r\n      headers: newHeaders,\r\n      observe: 'response' as 'body'\r\n    };\r\n\r\n    const newDeviceFingerprint = this.iaDfpService.IaDfp.readFingerprint();\r\n\r\n    const json = {\r\n      deviceFingerprint: newDeviceFingerprint\r\n    };\r\n    const body = JSON.stringify(json);\r\n    const url = this.domain + this.stepUpPath;\r\n\r\n    console.debug('Sending request: ');\r\n    console.debug('- url: ' + url);\r\n    console.debug('- authorization: ' + authorization);\r\n    console.debug('- body: ' + body);\r\n\r\n    return this.http.post<any>(url, body, options);\r\n  }\r\n\r\n  private async handleStepUpAuthentication(response: HttpResponse<IMfaMessage>) {\r\n    const res = response.body;\r\n    console.debug(response);\r\n    console.debug(res);\r\n\r\n    // Store transactionId\r\n    this.storageService.storeTransactionId(res.transactionId);\r\n\r\n    // If the user is not risky we can immediately return the provided VIP Token\r\n    // TODO: remove risky from response\r\n    if (res.risky) {\r\n      console.debug('User is required to use Multi-Factor Authentication');\r\n      console.debug(`Redirecting user to ${res.medium} page...`);\r\n\r\n      // Wait for the user to press the next button before routing to mfa page\r\n      await this.router.navigate([`/authentication/${res.medium.toString().toLowerCase()}`]);\r\n    } else {\r\n\r\n      // Store the token locally\r\n      this.storageService.storeVipToken(res.vipToken);\r\n\r\n      location.reload();\r\n    }\r\n  }\r\n\r\n  private logStepUpResponse(response: HttpResponse<IMfaMessage>) {\r\n    console.debug(response);\r\n    console.debug('\\'risky\\': ' + response.body.risky);\r\n    console.debug('\\'requestId\\': ' + response.body.requestId);\r\n    console.debug('\\'medium\\': ' + response.body.medium);\r\n    console.debug('\\'transactionId\\': ' + response.body.transactionId);\r\n    console.debug('\\'vipToken\\': ' + response.body.vipToken);\r\n  }\r\n\r\n  //  /* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * *\r\n  //      *                        INTERCEPT REQUEST HEADERS                      *\r\n  //      * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * */\r\n\r\n  //     // Custom headers with AAD and VIP authorization tokens\r\n  //     getRequestOptionArgs(options?: RequestOptionsArgs): RequestOptionsArgs {\r\n  //       if (options == null) {\r\n  //           options = new RequestOptions();\r\n  //       }\r\n  //       if (options.headers == null) {\r\n  //           options.headers = new Headers();\r\n  //       }\r\n  //       options.headers.append('Content-Type', 'application/json');\r\n\r\n  //       // Default headers\r\n  //       options.headers.append('Access-Control-Allow-Origin', '*');\r\n  //       options.headers.append('Access-Control-Allow-Methods', 'POST, GET, OPTIONS, DELETE');\r\n  //       options.headers.append('Access-Control-Max-Age', '3600');\r\n  //       options.headers.append('Access-Control-Allow-Headers', 'x-requested-with');\r\n\r\n  //       // NOTE: The error interceptor handles updating the authorization tokens when we get a 401\r\n\r\n  //       // AAD Token\r\n  //       const authorization = this.aadService.retrieveAadToken();\r\n  //       options.headers.append(this.AAD_TOKEN_HEADER, authorization);\r\n\r\n  //       // VIP Token\r\n  //       const authorizationVip = this.storage.retrieveVipToken();\r\n  //       options.headers.append(this.VIP_TOKEN_HEADER,  authorizationVip);\r\n\r\n  //       return options;\r\n  //   }\r\n\r\n\r\n\r\n\r\n  //   /* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * *\r\n  //    *                    USER AUTHORIZATION LOGIC [401]                     *\r\n  //    * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * */\r\n\r\n  //    // If the user is unable to reach the API endpoint we must ensure they are authenticated.\r\n  //    // The user is first authenticated with Azure AD\r\n  //    //     - If the user does not have a valid AAD token we redirect them to login to Azure AD\r\n  //    // The user is then required to have a VIP token\r\n  //    //     - The '/stepup' endpoint must be called and then the following may happen:\r\n  //    //         + If the user is not risky then we are immediately provided with the VIP token\r\n  //    //         + If the user is risky then they are redirect to the provided MFA medium (push or otp)\r\n  //    //             = NOTE: If the user is redirect to push or otp they will be redirected\r\n  //    //                     back home once they have a valid VIP token\r\n  //    private handleUserAuthorization(error: Response) {\r\n  //        // Store the user context so we can return here after handling the 401\r\n  //        this.storage.storeLastLocation();\r\n\r\n  //        // Check if the user is authenticated with Azure:\r\n  //        //      If they are, we have a valid AAD Token and we can continue.\r\n  //        //      If they are not, we redirect them to the Azure login page and leave\r\n  //        //       them there until they successfully login. They will then be redirected to the home page\r\n  //        if (this.checkNewAadTokenIsRequired(error)) {\r\n  //            this.getAadToken();\r\n  //        } else {\r\n  //            this.getVipToken();\r\n  //        }\r\n  //    }\r\n\r\n\r\n  //   /* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * *\r\n  //    *                             AAD TOKEN                                 *\r\n  //    * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * */\r\n\r\n  //   // If the 401 error response message contains 'VIP' then we know that the user\r\n  //   // either did not proved an AAD token or the provided AAD token is invalid.\r\n  //   // If the message does NOT contain 'VIP' then the provided AAD token was valid\r\n  //   // and we may simple return the currently stored AAD token.\r\n  //   private getAadToken() {\r\n  //       // If the user has selected an Azure instance then we can simply return\r\n  //       // their AAD token otherwise we redirect them to the /login page\r\n\r\n  //       // TODO: DH - Look into this, is there a missing line below? Code doesn't match the comments\r\n  //       if (this.storage.retrieveAzureInstance()) {\r\n  //           console.debug('User has already selected an Azure instance. Redirecting to Azure login page...');\r\n  //       } else {\r\n  //           console.debug('User has already NOT selected an Azure instance yet. Redirecting user to login page...');\r\n  //       }\r\n\r\n  //       // Always send the user to select an Azure instance to log in to.\r\n  //       // (even if they have previously selected an Azure instance)\r\n  //       this.router.navigate(['/authentication/login']);\r\n  //   }\r\n\r\n  //   // When the error message contains 'VIP' we know the AAD token was valid and we can just return it\r\n  //   private checkNewAadTokenIsRequired(error: Response) {\r\n  //       let required = true;\r\n  //       const re = /(vip|VIP)/;\r\n  //       if (error.json().message.search(re) !== -1) {\r\n  //           required = false;\r\n  //       }\r\n  //       return required;\r\n  //   }\r\n\r\n\r\n\r\n\r\n  //   /* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * *\r\n  //    *                       CONTACT ADMIN LOGIC [403]                       *\r\n  //    * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * */\r\n\r\n  private async handleContactAdmin(error: VipHttpErrorResonse) {\r\n    const body = error;\r\n\r\n    console.debug('Handling Operation Not Allowed');\r\n    console.debug('User is unable to continue authorization process.');\r\n    console.debug(body.error);\r\n    console.debug('Redirecting user to contact admin page...');\r\n\r\n    await this.router.navigate(['/authentication/contact-admin /' + body.requestId]);\r\n  }\r\n\r\n\r\n  //    /* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * *\r\n  //     *                       REGISTRATION LOGIC [404]                        *\r\n  //     * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * */\r\n\r\n  private async handleRegistration(error: VipHttpErrorResonse) {\r\n    const body = error;\r\n\r\n    console.debug('Handling Registration');\r\n\r\n    console.debug('User has not yet registered with VIP');\r\n    console.debug(body.error);\r\n    console.debug('Redirecting user to registration page...');\r\n\r\n    await this.router.navigate(['/authentication/register']);\r\n  }\r\n\r\n\r\n  //   /* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * *\r\n  //    *                    OVERRIDE DEFAULT HTTP METHODS                      *\r\n  //    * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * */\r\n\r\n  //   request(url: string | Request, options?: RequestOptionsArgs): Observable<Response> {\r\n  //       return super.request(url, options);\r\n  //   }\r\n\r\n  //   get(url: string, options?: RequestOptionsArgs): Observable<Response> {\r\n  //       console.debug('Intercepted GET Request:');\r\n  //       console.debug('- url: ' + url);\r\n  //       return this.intercept(super.get(url, this.getRequestOptionArgs(options)));\r\n  //   }\r\n\r\n  //   post(url: string, body: string, options?: RequestOptionsArgs): Observable<Response> {\r\n  //       console.debug('Intercepted POST Request:');\r\n  //       console.debug('- url: ' + url);\r\n  //       return this.intercept(super.post(url, body, this.getRequestOptionArgs(options)));\r\n  //   }\r\n\r\n  //   put(url: string, body: string, options?: RequestOptionsArgs): Observable<Response> {\r\n  //       return this.intercept(super.put(url, body, this.getRequestOptionArgs(options)));\r\n  //   }\r\n\r\n  //   delete(url: string, options?: RequestOptionsArgs): Observable<Response> {\r\n  //       return this.intercept(super.delete(url, this.getRequestOptionArgs(options)));\r\n  //   }\r\n  // }\r\n\r\n}\r\nexport interface HttpAuthRequest {\r\n  [index: string]: string;\r\n}\r\n","import { Component, Input } from '@angular/core';\r\n\r\n@Component({\r\n  selector: 'lib-spinner',\r\n  templateUrl: './spinner.component.html',\r\n  styleUrls: ['./spinner.component.css']\r\n})\r\nexport class SpinnerComponent {\r\n  isDelayedRunning = false;\r\n\r\n  constructor() { }\r\n\r\n  @Input()\r\n  public set isRunning(value: boolean) {\r\n    this.isDelayedRunning = value;\r\n  }\r\n}\r\n","import { Component, OnInit } from '@angular/core';\r\n\r\n@Component({\r\n  selector: 'lib-tick',\r\n  templateUrl: './tick.component.html',\r\n  styleUrls: ['./tick.component.css']\r\n})\r\nexport class TickComponent implements OnInit {\r\n\r\n  constructor() { }\r\n\r\n  ngOnInit() {\r\n  }\r\n\r\n}\r\n","import { CommonModule } from '@angular/common';\nimport { HTTP_INTERCEPTORS } from '@angular/common/http';\nimport { ModuleWithProviders, NgModule } from '@angular/core';\nimport { NswhpAuthMaterialModule } from './authentication-material/nswhpauth-material.module';\nimport { AzureLoginComponent } from './components/azure-login/azure-login.component';\nimport { AzureLogoutComponent } from './components/azure-logout/azure-logout.component';\nimport { ContactAdminComponent } from './components/contact-admin/contact-admin.component';\nimport { OtpComponent } from './components/otp/otp.component';\nimport { PushComponent } from './components/push/push.component';\nimport { RegisterComponent } from './components/register/register.component';\nimport { AadService } from './services/aad.service';\nimport { AuthenticationInterceptorService } from './services/AuthenticationInterceptor.service';\nimport { IaDfpService } from './services/iadfp.service';\nimport { StorageService } from './services/storage.service';\nimport { VipService } from './services/vip.service';\nimport { SpinnerComponent } from './components/spinner/spinner.component';\nimport { TickComponent } from './components/tick/tick.component';\nimport { INswhpAuthServiceOptions, NSWHP_AUTH_CONFIG } from './nswhpauth-config';\nimport { AdalService } from 'adal-angular4';\n\n\n\n@NgModule({\n  declarations: [\n    AzureLoginComponent,\n    AzureLogoutComponent,\n    OtpComponent,\n    PushComponent,\n    RegisterComponent,\n    SpinnerComponent,\n    TickComponent,\n    ContactAdminComponent,\n  ],\n  exports: [\n    AzureLoginComponent,\n    AzureLogoutComponent,\n    OtpComponent,\n    PushComponent,\n    RegisterComponent,\n    SpinnerComponent,\n    TickComponent,\n    ContactAdminComponent,\n  ],\n  imports: [\n    CommonModule,\n    NswhpAuthMaterialModule,\n  ],\n  providers: [\n    StorageService,\n    IaDfpService,\n    NswhpAuthMaterialModule,\n    {\n      provide: HTTP_INTERCEPTORS,\n      useClass: AuthenticationInterceptorService,\n      multi: true\n    },\n    AadService,\n    VipService,\n    AdalService\n  ],\n  entryComponents: [\n    AzureLoginComponent,\n    AzureLogoutComponent,\n    OtpComponent,\n    PushComponent,\n    RegisterComponent,\n    SpinnerComponent,\n    TickComponent,\n    ContactAdminComponent,\n  ]\n})\nexport class NswhpAuthModule {\n  static forRoot(config: INswhpAuthServiceOptions): ModuleWithProviders<NswhpAuthModule> {\n    return {\n      ngModule: NswhpAuthModule,\n      providers: [\n        { provide: NSWHP_AUTH_CONFIG, useValue: config },\n      ]\n    };\n  }\n}\n","import { NgModule } from '@angular/core';\r\nimport { Routes, RouterModule } from '@angular/router';\r\nimport { AzureLoginComponent } from './components/azure-login/azure-login.component';\r\nimport { AzureLogoutComponent } from './components/azure-logout/azure-logout.component';\r\nimport { ContactAdminComponent } from './components/contact-admin/contact-admin.component';\r\nimport { OtpComponent } from './components/otp/otp.component';\r\nimport { PushComponent } from './components/push/push.component';\r\nimport { RegisterComponent } from './components/register/register.component';\r\n\r\nconst routes: Routes = [\r\n  { path: 'authentication/otp', component: OtpComponent },\r\n  { path: 'authentication/login', component: AzureLoginComponent },\r\n  { path: 'authentication/login/:tenantConfigId', component: AzureLoginComponent },\r\n  { path: 'authentication/logout', component: AzureLogoutComponent },\r\n  { path: 'authentication/register', component: RegisterComponent },\r\n  { path: 'authentication/push', component: PushComponent },\r\n  { path: 'authentication/contact-admin', component: ContactAdminComponent }\r\n];\r\nexport const routerModuleForRoot = RouterModule.forRoot(routes);\r\n\r\n@NgModule({\r\n  imports: [routerModuleForRoot],\r\n  exports: [RouterModule]\r\n})\r\nexport class NswhpAuthRoutingModule { }\r\n","/*\n * Public API Surface of nswhpauth\n */\n\nexport * from './lib/nswhpauth.service';\nexport * from './lib/nswhpauth.module';\nexport * from './lib/nswhpauth.routing.module';\nexport * from './lib/components';\n","/**\n * Generated bundle index. Do not edit.\n */\n\nexport * from './public-api';\n\nexport {NswhpAuthMaterialModule as ɵo} from './lib/authentication-material/nswhpauth-material.module';\nexport {AzureLoginComponent as ɵc} from './lib/components/azure-login/azure-login.component';\nexport {AzureLogoutComponent as ɵf} from './lib/components/azure-logout/azure-logout.component';\nexport {ContactAdminComponent as ɵn} from './lib/components/contact-admin/contact-admin.component';\nexport {OtpComponent as ɵg} from './lib/components/otp/otp.component';\nexport {PushComponent as ɵj} from './lib/components/push/push.component';\nexport {RegisterComponent as ɵk} from './lib/components/register/register.component';\nexport {SpinnerComponent as ɵl} from './lib/components/spinner/spinner.component';\nexport {TickComponent as ɵm} from './lib/components/tick/tick.component';\nexport {INswhpAuthServiceOptions as ɵa,NSWHP_AUTH_CONFIG as ɵb} from './lib/nswhpauth-config';\nexport {AuthenticationInterceptorService as ɵp} from './lib/services/AuthenticationInterceptor.service';\nexport {AadService as ɵd} from './lib/services/aad.service';\nexport {IaDfpService as ɵi} from './lib/services/iadfp.service';\nexport {StorageService as ɵe} from './lib/services/storage.service';\nexport {VipService as ɵh} from './lib/services/vip.service';"],"names":["InjectionToken","Injectable","Inject","MatButtonModule","MatCardModule","MatChipsModule","MatFormFieldModule","MatIconModule","MatInputModule","MatRadioModule","NgModule","jwtDecode_","AdalService","Component","Router","ActivatedRoute","map","catchError","tap","EMPTY","throwError","HttpClient","HttpStatus.UNAUTHORIZED","HttpStatus.FORBIDDEN","HttpStatus.NOT_FOUND","HttpHeaders","Input","CommonModule","HTTP_INTERCEPTORS","RouterModule"],"mappings":"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"}